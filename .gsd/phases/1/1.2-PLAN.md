---
phase: 1
plan: 2
wave: 1
depends_on: []
files_modified: [app/components/confidence-coach/MediaPipeAnalyzer.js]
autonomous: true

must_haves:
  truths:
    - "MediaPipe Face and Pose detection models load successfully"
    - "Landmarks are extracted from the active video feed"
  artifacts:
    - "app/components/confidence-coach/MediaPipeAnalyzer.js"
---

# Plan 1.2: MediaPipe Face & Pose Integration

<objective>
To integrate Google's local-browser MediaPipe models for pose and face landmark tracking over the active video stream, collecting frame-by-frame data points.
Purpose: This is the core engine for recognizing facial confidence and body language (sitting vs standing).
Output: A utility JS module that tracks Face/Pose and updates a shared data ref.
</objective>

<context>
Load for context:
- .gsd/SPEC.md
- app/components/confidence-coach/ConfidenceCoachUI.jsx
</context>

<tasks>

<task type="auto">
  <name>Install MediaPipe Dependencies</name>
  <files>package.json</files>
  <action>
    Install `@mediapipe/tasks-vision`.
    AVOID: Installing the old '@mediapipe/face_mesh' legacy packages. Use the new Tasks Vision API.
  </action>
  <verify>npm ls @mediapipe/tasks-vision</verify>
  <done>Package installed and verifiable in package.json.</done>
</task>

<task type="auto">
  <name>Implement MediaPipe Analyzer class/hook</name>
  <files>app/components/confidence-coach/MediaPipeAnalyzer.js</files>
  <action>
    Create a helper to load `FaceLandmarker` and `PoseLandmarker` from `@mediapipe/tasks-vision`.
    Export a function `startMediaPipeStream(videoElement, onResults)` that runs a `requestAnimationFrame` loop calling `detectForVideo`.
    The `onResults` callback should pass back the detected face shape and pose skeleton data.
    AVOID: Re-instantiating the models every frame. Load them once and use `detectForVideo`.
  </action>
  <verify>npm run lint or verify no syntax errors building this file</verify>
  <done>Module successfully hooks into a video element and provides continuous detection results.</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] @mediapipe/tasks-vision dependency exists.
- [ ] Analyzer successfully initializes without throwing bundle/WASM errors.
</verification>

<success_criteria>
- [ ] All tasks verified
- [ ] Must-haves confirmed
</success_criteria>
